<layout name='Layout/aeropms_home' />
<script type="text/javascript">
    function zTreeOnClick(event, treeId, treeNode) {
        var wt = treeNode.wbs_type;
        //alert("wbs_type="+wt);
    };

    function setFontCss(treeId, treeNode) {
        return treeNode.node_type == "pbs" ? {color:"Gray"} : {color: "Black"};
    };

    var setting = {
        callback: {onClick: zTreeOnClick},
        view: {
            fontCss: setFontCss
        }
    };

    var nodes = {$node_json|default="[空节点]"};
    $(document).ready(function(){
        $.fn.zTree.init($("#wbs_tree"), setting, nodes);
    });
</script>
<input type="hidden" name="ajax" id="ajax" value="0">
<!--
{:W('PageHeader',array('name'=>$folder_name,'search'=>'N'))}
-->
<!--
<div class="operate panel panel-default">
    <div class="panel-body">
        <div class="pull-right">
            <a onclick="add()" class="btn btn-sm btn-primary">新增</a>
            <a onclick="save()" class="btn btn-sm btn-primary">保存</a>
            |
            <a onclick="del()" class="btn btn-sm btn-danger">删除</a>
        </div>
    </div>
</div>
-->
<div class="row">
    <div class="col-xs-12 col-sm-6">
        <!-- WBS节点树开始 -->
        <div>
            <div class="widget-header">
                <h4>WBS节点树</h4>
                <div class="widget-toolbar">
                    <a href="#" data-action="collapse">
                        <i class="icon-bell bigger-110 purple"></i>
                        list
                    </a>

                    <a href="#" data-action="close">
                        <i class="icon-remove"></i>
                    </a>
                </div>

            </div>
            <div class="widget-body">
                <div class="widget-main">
                    <div class="row">
                        <!--<h5 class="lead">
                            PBS节点: {$Think.session.pbs_node_path}, ID={$Think.session.pbs_node_id}
                        </h5>-->
                        <div class="col-xs-12 col-sm-6">
                            <present name="node_json">
                                <ul id="wbs_tree" class="ztree"></ul>
                            </present>
                        </div>

                        <div class="col-xs-12 col-sm-6">
                            <div class="operate panel panel-default">
                                <div class="panel-body">
                                    <button class="btn btn-primary btn-sm">
                                        <i class="fa fa-edit bigger-110"></i>
                                        新增
                                    </button>
                                    <button class="btn btn-primary btn-sm">
                                        <i class="fa fa-cogs bigger-100"></i>编辑
                                    </button>
                                </div>

                            </div>

                            <ul class="list-unstyled spaced">
                                <li>
                                    <i class="icon-bell bigger-110 purple"></i>
                                    List with custom icons and more space
                                </li>

                                <li>
                                    <i class="icon-ok bigger-110 green"></i>
                                    Unordered List Item # 2
                                </li>

                                <li>
                                    <i class="icon-remove bigger-110 red"></i>
                                    Unordered List Item # 3
                                </li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!--WBS信息框-->
    <div class="col-xs-12 col-sm-6">
        <form id="form_data" name="form_data" method="post" post_url="{:U('wbs/add')}" class="well form-horizontal clearfix">
            <div>
                <p class="lead">
                    添加WBS子节点
                </p>
            </div>

            <input type="hidden" name="project_id" id="project_id" value="{$proj_id}">
            <input type="hidden" name="pbs_id" id="pbs_id" value="{$Think.session.pbs_node_id}">
            <input type="hidden" name="parent_id" id="parent_id" value="">

            <div class="form-group">
                <label class="col-sm-3 control-label" for="name">名称* </label>
                <div class="col-sm-9">
                    <input class="form-control" type="text" id="name" name="name" check="require" msg="请输入WBS名称">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label" for="desc">描述* </label>
                <div class="col-sm-9">
                    <input class="form-control" type="text" id="desc" name="desc" check="require" msg="请输入WBS内容描述">
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label" for="type">WBS类型*</label>
                <div class="col-sm-9">
                    <div class="input-group">
                        <select id="type" name="type" form="form_data">
                            <volist name="type_list" id="vo">
                                <option value="{$vo.id}">{$vo.name}</option>
                            </volist>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label" for="engineering_phase">工程阶段*</label>
                <div class="col-sm-9">
                    <div class="input-group">
                        <select id="engineering_phase" name="engineering_phase" form="form_data">
                            <volist name="engineering_phase" id="vo">
                                <option value="{$vo.id}">{$vo.name}</option>
                            </volist>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label" for="remark" >备注</label>
                <div class="col-sm-9" >
                    <textarea class="form-control" name="remark" id="remark" rows="5" class="col-xs-12" ></textarea>
                </div>
            </div>
        </form>

        <div class="operate panel panel-default">
            <div class="panel-body">
                <div class="pull-right">
                    <!--<a onclick="add()" class="btn btn-sm btn-primary">新增</a>-->
                    <a onclick="add()" class="btn btn-sm btn-primary">添加</a>
                    |
                    <a onclick="clear()" class="btn btn-sm btn-danger">清空</a>
                </div>
            </div>
        </div>
    </div>
</div>